@SHIBORITORI(射精キャラ番号, 被射精キャラ番号)
#DIM 射精キャラ番号
#DIM 被射精キャラ番号
#DIMS 射精部位1
#DIMS 射精部位2

;なんかDIMとか使って微妙に分かりにくいかもしれないけど、これは最初に射精確定後処理に入れようとしてやっぱり止めた時の名残なので
;気にしなくていいです　地の文が最初に表示されちゃう

IF 射精キャラ番号 == MASTER
;あなたが突っ込んでる場合
	IF Ｓ度判定(被射精キャラ番号,射精キャラ番号) < RAND:(MAX((100 - ABL:被射精キャラ番号:欲望 * 5), 20))
		IF TALENT:被射精キャラ番号:献身的 && BASE:射精キャラ番号:気力 == 0
			PRINTFORMW %CALLNAME:被射精キャラ番号%担心%CALLNAME:射精キャラ番号%的身体、放开了%CALLNAME:射精キャラ番号%的陰茎……
		ELSE
			PRINTFORMW %CALLNAME:被射精キャラ番号%在%CALLNAME:射精キャラ番号%射精结束后、露出満足的微笑将%CALLNAME:射精キャラ番号%陰茎拔了出来……
		ENDIF
		CALL 挿入解除(被射精キャラ番号)
		TFLAG:106 = 0
	ELSE
		IF TALENT:被射精キャラ番号:施虐狂
			IF TALENT:射精キャラ番号:受虐狂
				IF BASE:被射精キャラ番号:気力 > 0
					IF BASE:射精キャラ番号:気力 == 0
						PRINTFORML %CALLNAME:被射精キャラ番号%完全没有放过%CALLNAME:射精キャラ番号%的意思
						PRINTFORMW %CALLNAME:被射精キャラ番号%的膣肉紧紧缠住%CALLNAME:射精キャラ番号%的陰茎、为了索求更多的射精开始蠕動起来……
					ELSE
						PRINTFORMW %CALLNAME:被射精キャラ番号%像不让逃走似的牢牢抓住%CALLNAME:射精キャラ番号%的手臂、开始剧烈地晃起了腰……
					ENDIF
				ELSEIF BASE:射精キャラ番号:気力 == 0
					PRINTFORMW %CALLNAME:被射精キャラ番号%逆推了精疲力尽的%CALLNAME:射精キャラ番号%、开始剧烈地晃起了腰……
				ELSE
					PRINTFORMW %CALLNAME:被射精キャラ番号%確認%CALLNAME:射精キャラ番号%射精结束之后、开始间不容发地晃起了腰……
				ENDIF
			ELSEIF BASE:被射精キャラ番号:気力 > 0
				PRINTFORMW %CALLNAME:被射精キャラ番号%为了榨取%CALLNAME:射精キャラ番号%更多的精液而再次开始晃起了腰……
			ELSEIF BASE:射精キャラ番号:気力 == 0
				PRINTFORMW %CALLNAME:被射精キャラ番号%逆推了精疲力尽的%CALLNAME:射精キャラ番号%、再次开始晃起了腰……
			ELSE
				PRINTFORMW %CALLNAME:被射精キャラ番号%確認%CALLNAME:射精キャラ番号%射精结束之后、开始间不容发地再次晃起了腰……
			ENDIF
		ELSE
			IF TALENT:被射精キャラ番号:献身的 && BASE:射精キャラ番号:気力 == 0
				PRINTFORMW %CALLNAME:被射精キャラ番号%因为还没有満足、一边向%CALLNAME:射精キャラ番号%道歉一边再次开始晃起了腰……
			ELSE
				PRINTFORMW %CALLNAME:被射精キャラ番号%在%CALLNAME:射精キャラ番号%射精结束之后、亲了亲%CALLNAME:射精キャラ番号%的脸颊就又开始晃起了腰……
			ENDIF
		ENDIF
	ENDIF
ELSE
;あなたに突っ込んでる場合
	IF TCVAR:TARGET:已射精部位FLAG == 1
		射精部位1 = 膣内
		射精部位2 = 膣道
	ELSE
		射精部位1 = 菊穴
		射精部位2 = 菊穴
	ENDIF

	IF Ｓ度判定(射精キャラ番号, 被射精キャラ番号) - 引き抜き精力補正(射精キャラ番号) < RAND:(MAX((100 - ABL:被射精キャラ番号:欲望 * 5), 20))
		IF TALENT:射精キャラ番号:献身的 && BASE:被射精キャラ番号:気力 == 0
			PRINTFORMW %CALLNAME:射精キャラ番号%擔心%CALLNAME:被射精キャラ番号%的身體、從%CALLNAME:被射精キャラ番号%的%射精部位2%中拔出了肉棒……
		ELSE
			PRINTFORMW %CALLNAME:射精キャラ番号%終於在%CALLNAME:被射精キャラ番号%的%射精部位1%射完了精液、露出滿足的微笑拔出了肉棒……
		ENDIF
		CALL 挿入解除(被射精キャラ番号)
		CALL TOUCH_SET(0, 0, 射精キャラ番号, 1)
	ELSE
		IF TALENT:射精キャラ番号:施虐狂
			IF TALENT:被射精キャラ番号:受虐狂
				IF BASE:射精キャラ番号:気力 > 0
					IF BASE:被射精キャラ番号:気力 == 0
						PRINTFORML %CALLNAME:射精キャラ番号%完全没有放过%CALLNAME:被射精キャラ番号%的意思
						PRINTFORMW %CALLNAME:射精キャラ番号%的肉棒在瞬間就重新恢復了硬度、開始抽插著%CALLNAME:被射精キャラ番号%的%射精部位2%……
					ELSE
						PRINTFORMW %CALLNAME:射精キャラ番号%像不让逃跑似的牢牢抓住%CALLNAME:被射精キャラ番号%的手臂、开始剧烈地耸动起腰身……
					ENDIF
				ELSEIF BASE:射精キャラ番号:気力 == 0
					PRINTFORMW %CALLNAME:射精キャラ番号%逆推了精疲力尽的%CALLNAME:被射精キャラ番号%、开始剧烈地耸动起腰身……
				ELSE
					PRINTFORMW %CALLNAME:射精キャラ番号%射精结束后、抱住依偎过来的%CALLNAME:被射精キャラ番号%、再次动起了腰……
				ENDIF
			ELSEIF BASE:射精キャラ番号:気力 > 0
				PRINTFORMW %CALLNAME:射精キャラ番号%為了再次在%CALLNAME:被射精キャラ番号%的%射精部位1%射入更多的精液再次動起了腰……
			ELSEIF BASE:被射精キャラ番号:気力 == 0
				PRINTFORMW %CALLNAME:射精キャラ番号%逆推了精疲力尽的%CALLNAME:被射精キャラ番号%、再次动起了腰……
			ELSE
				PRINTFORMW %CALLNAME:射精キャラ番号%射精结束后、抱住依偎过来的%CALLNAME:被射精キャラ番号%、再次动起了腰……
			ENDIF
		ELSE
			IF TALENT:射精キャラ番号:献身的 && BASE:被射精キャラ番号:気力 == 0
				PRINTFORMW %CALLNAME:射精キャラ番号%因为还没有満足、一边向%CALLNAME:被射精キャラ番号%道歉一边再次开始动起了腰……
			ELSE
				PRINTFORMW %CALLNAME:射精キャラ番号%在%CALLNAME:被射精キャラ番号%的%射精部位1%射完之後、親了親%CALLNAME:被射精キャラ番号%的臉頰之後再次動起了腰……
			ENDIF
		ENDIF
	ENDIF
ENDIF

@Ｓ度判定(攻め,受け)
#FUNCTION

#DIM 攻め
#DIM 受け

VARSET LOCAL

LOCAL += ABL:攻め:施虐属性 * 5
LOCAL -= ABL:攻め:受虐属性 * 5
LOCAL += ABL:受け:受虐属性 * 5
LOCAL -= ABL:受け:施虐属性 * 5

IF TALENT:攻め:施虐狂
	IF TALENT:受け:受虐狂
		IF BASE:攻め:気力 > 0
			IF BASE:受け:気力 <= 0
				LOCAL += 999
			ELSE
				LOCAL += 90
			ENDIF
		ELSEIF BASE:受け:気力 <= 0
			LOCAL += 75
		ELSE
			LOCAL += 60
		ENDIF
	ELSEIF BASE:攻め:気力 > 0
		IF BASE:受け:気力 <= 0
			LOCAL += 50
		ELSE
			LOCAL += 30
		ENDIF
	ELSEIF BASE:受け:気力 <= 0
		LOCAL += 20
	ELSE
		LOCAL += 10
	ENDIF
ELSE
	IF TALENT:受け:受虐狂
		IF BASE:攻め:気力 > 0
			IF BASE:受け:気力 <= 0
				LOCAL += 75
			ELSE
				LOCAL += 60
			ENDIF
		ELSEIF BASE:受け:気力 <= 0
			LOCAL += 50
		ELSE
			LOCAL += 35
		ENDIF
	ELSE
		SIF BASE:受け:気力 <= 0
			LOCAL += 10
		SIF BASE:攻め:気力 > 0
			LOCAL += 10
	ENDIF
ENDIF

;反抗的
SIF TALENT:攻め:態度 == 1
	LOCAL += 5

;自制心
SIF TALENT:攻め:自制心
	LOCAL -= 10

;快感に素直
IF TALENT:攻め:快感応答 == -1
	LOCAL += 10
;快感に素直
ELSEIF TALENT:攻め:快感応答 == 1
	LOCAL -= 5
ENDIF

SIF TALENT:攻め:献身的 && BASE:受け:気力 <= 0
	LOCAL /= 5
SIF TALENT:受け:施虐狂
	LOCAL /= 2

RETURNF MAX(LOCAL, 0)

@引き抜き精力補正(ARG)
#FUNCTION
RETURNF (MAXBASE:ARG:精力 - BASE:ARG:精力) * 50 / MAXBASE:ARG:精力 + 5
