;--------------------------------------------------
;	マップ内移動処理拡張パッチ付属
;		地底MAP用関数
;--------------------------------------------------
@MAP_PLACENAME_9(ARG)
#FUNCTIONS
#DIM PLACEID
IF GET_MAPID(ARG) == MAIN_MAP
	SELECTCASE ARG
		CASE 901 TO (MAXROOM - 1)
			RETURNF STR:(ARG + 8000)
		CASE 998
			RETURNF OMANEKI_PLACE()
		CASE 999
			RETURNF "间隙空間"
		CASE MAXROOM
			RETURNF "地上"
		CASEELSE
			RETURNF "不明"
	ENDSELECT
ELSE
	RETURNF "不明"
ENDIF

;@MAP_VIEWING_9
;
;SIF CHK_FOCUS(927,CFLAG:MASTER:現在位置,930)
;	CALL MAP_OLD_HELL
;SIF CHK_FOCUS(902,CFLAG:MASTER:現在位置,926)
;	CALL MAP_TIREIDEN
;SIF (CFLAG:MASTER:現在位置 == 901) || CHK_FOCUS(931,CFLAG:MASTER:現在位置,948)
;	CALL MAP_OLD_CITY
;RETURN 1

@MAP_VIEWING_9(AA)
#DIMS REF AA, 0
IF !TFLAG:地圖切換
	IF CHK_FOCUS(927,CFLAG:MASTER:現在位置,930)
		TFLAG:地圖切換 = 3
	ELSEIF (CFLAG:MASTER:現在位置 == 901) || CHK_FOCUS(931,CFLAG:MASTER:現在位置,948)
		TFLAG:地圖切換 = 2
	ELSE
		TFLAG:地圖切換 = 1
	ENDIF
ENDIF
CALL DRAW_INFORMATIONLINE(@"%MAPNAME:(TFLAG:地圖切換)%")
PRINTFORML 
TRYCALLFORM MAP_CHIREIDEN_{TFLAG:地圖切換}(AA)


@MAP_CAN_MOVE_9(ARG, ARG:1)
#FUNCTION
#DIM 在宅
SELECTCASE ARG
	;旧西階段、東階段、噴水、地蔵
	CASE 907, 908, 924, 947
		RETURNF 0
	;ラブホ,あなた以外は入らない
	CASE 935
		SIF ARG:1 != MASTER
			RETURNF 0
	CASEELSE
		RETURNF 1
ENDSELECT
RETURNF 1

@MAP_CANNOT_WORD_9(ARG)
SELECTCASE TFLAG:移動不能メッセージ
ENDSELECT
;PRINTW 工事中
;CLEARLINE 2
;REUSELASTLINE 
;RETURN
