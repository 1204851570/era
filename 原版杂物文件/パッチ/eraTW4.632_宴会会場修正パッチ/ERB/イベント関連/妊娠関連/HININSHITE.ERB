@HININSHITE(ARG)

IF ESTRUS_CYCLE(ARG) == 150
	LOCALS = 危険日な
ELSEIF ESTRUS_CYCLE(ARG) != 15
	LOCALS = 安全日じゃない
ENDIF

IF TALENT:ARG:153
	;PRINTL Feed
	IF CFLAG:ARG:妊娠経過日数 <= 30
		PRINTFORML %CALLNAME:ARG%はまだ体が不安なので安定期まで待って欲しいと言いながら挿入を拒絶した。
		TFLAG:16 = 1
	ELSEIF CFLAG:ARG:妊娠経過日数 >= 71
		PRINTFORML %CALLNAME:ARG%は出産が近くなったので出産まで待って欲しいと言いながら挿入を拒絶した。
		TFLAG:16 = 1
	ENDIF
	RETURN 0
ENDIF
;WAIT

IF CFLAG:ARG:育児人数 >= 1 && CFLAG:ARG:育児人数 <= 3
	PRINTFORML %CALLNAME:ARG%はこれ以上のこどもを同時に育てるのはさすがに無理なので
	PRINTFORML ちゃんと避妊してほしいと言ってきた…
ELSE
	PRINTFORML %CALLNAME:ARG%は今日は%LOCALS%のでちゃんと避妊してほしいと言ってきた…
ENDIF

IF CFLAG:ARG:允许无套 < 2
	CALL KOJO_MESSAGE_SEND("EVENT",18,TARGET,1,0)
ELSE
	CALL KOJO_MESSAGE_SEND("EVENT",31,TARGET,0,0)
ENDIF

WAIT
PRINTFORML [1] 避孕套をつける（残り{ITEM:45}枚）
PRINTFORML [2] 口服避孕薬を渡す（残り{ITEM:49}錠）
SIF !TCVAR:懇願 && !CFLAG:ARG:育児人数
PRINTL [3] ナマでやらせて下さいお願いします
SIF (TEQUIP:TARGET:縄 || TEQUIP:TARGET:拘束) && !CFLAG:ARG:育児人数
PRINTL [4] いいや妊娠だけは絶対して貰う
SIF CFLAG:ARG:育児人数 && CFLAG:ARG:子育て中解禁 == 0
PRINTL [5] 本当に避妊してほしいか聞いてみる

PRINTL [0] あきらめる
$LOOP
INPUT
IF RESULT == 1
	IF !ITEM:45
		PRINTL 避孕套を持っていない
		GOTO LOOP
	ELSE
		ITEM:45 -= 1
		PRINTL 避孕套をつけた
		TEQUIP:MASTER:避孕套 = 1
	ENDIF
ELSEIF RESULT == 2
	IF !ITEM:49
		PRINTL 口服避孕薬を持っていない
		GOTO LOOP
	ELSE
		ITEM:49 -= 1
		TCVAR:ARG:口服避孕薬 = 1
		PRINTFORML %CALLNAME:ARG%に口服避孕薬を飲んでもらった 
	ENDIF
ELSEIF RESULT == 3 && !CFLAG:ARG:育児人数
	TCVAR:ARG:懇願 = 1
	CALL OGAMITAOSHI(ARG)
ELSEIF RESULT == 4 && !CFLAG:ARG:育児人数
	TCVAR:ARG:强行 = 1
ELSEIF RESULT == 5 && CFLAG:ARG:育児人数
	CALL NAMA_POISONING(ARG)
ELSE
	TFLAG:16 = 3
	TFLAG:17 = ARG
ENDIF
RETURN 0

@避妊要求(ARG)
IF 妊娠可否(ARG) && TALENT:MASTER:2 & 2 && !TFLAG:16 && !TALENT:ARG:無知 && !TCVAR:ARG:强行 && !TCVAR:ARG:烂醉
	IF !CFLAG:ARG:允许无套 && ESTRUS_CYCLE(ARG) != 15
		CALL HININSHITE(ARG)
	ELSEIF CFLAG:ARG:允许无套 < 2 && ESTRUS_CYCLE(ARG) == 150
		CALL HININSHITE(ARG)
	ELSEIF TALENT:ARG:育児中 && CFLAG:ARG:出産経過日 <= 50 && !TFLAG:16 && ESTRUS_CYCLE(TARGET) != 15 && !CFLAG:ARG:子育て中解禁
		CALL HININSHITE(ARG)
	ENDIF
ENDIF

@妊娠可否(ARG)
#FUNCTION
SIF TEQUIP:PLAYER:避孕套 || TCVAR:ARG:口服避孕薬
	RETURNF 0
SIF TALENT:ARG:幼稚 && !TALENT:ARG:初潮
	RETURNF 0
SIF TALENT:ARG:非生物 || TALENT:ARG:蓬莱人 || TALENT:ARG:妊娠
	RETURNF 0
RETURNF 1